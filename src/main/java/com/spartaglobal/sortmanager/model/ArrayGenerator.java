package com.spartaglobal.sortmanager.model;

import com.spartaglobal.sortmanager.SortManagerMain;
import com.spartaglobal.sortmanager.view.DisplayManager;
import java.util.Random;
import java.util.Scanner;

public class ArrayGenerator {
    private int[] unsortedArray;

    /**
     * Generates an array of given size populated with random numbers within given range.
     *
     * @param size desired size of the array
     * @param bounds desired range of the numbers in the array
     */
    public void generateRandomArray(int size, int bounds){
        // Create an array and populate it with random numbers within a given range
        Random r = new Random();
        int[] array = new int[size];
        for(int i = 0; i < array.length; i++){
            array[i] = r.nextInt(-bounds, bounds+1);
        }
        // Assign the created random array to the unsortedArray variable
        unsortedArray = array;
    }

    /**
     * Returns the unsorted array generated by one of the methods in this class.
     *
     * @return unsorted array
     */
    public int[] getUnsortedArray() {
        return unsortedArray;
    }

    /**
     * Generates a custom array of given size populated with given numbers.
     *
     * @param size desired size of the array
     */
    public void generateCustomArray(int size){
        // Read numbers from user, populate the array
        Scanner sc = new Scanner(System.in);
        int[] createdArray = new int[size];
        for(int i = 0; i < createdArray.length; i++){
            System.out.println("------------------------------------------\n"
                    + "Enter a value: ");
            // Loop back in case of wrong input
            while(!sc.hasNextInt()){
                SortManagerMain.logger.warn("Incorrect value entered!");
                System.out.println("Incorrect number! Enter a number: ");
                sc.next();
            }
            createdArray[i] = sc.nextInt();
        }
        // Assign the array to the unsortedArray variable
        unsortedArray = createdArray;
    }

    /**
     * Select which array type to generate based in desiredArrayType variable.
     *
     * @param desiredArrayType desired array type entered by user
     */
    public void generateArray(String desiredArrayType){
        DisplayManager view = new DisplayManager();
        if(desiredArrayType.equals("random")){
            int arraySize = getDesiredArraySize();
            SortManagerMain.logger.debug("arraySize= " + arraySize);
            int arrayBounds = getDesiredArrayBounds();
            SortManagerMain.logger.debug("arrayBounds= " + arrayBounds);

            generateRandomArray(arraySize, arrayBounds);
            SortManagerMain.logger.debug("Unsorted array= " + view.displayArray(getUnsortedArray()));
        }
        else{
            int arraySize = getDesiredArraySize();
            SortManagerMain.logger.debug("arraySize= " + arraySize);
            generateCustomArray(arraySize);
            SortManagerMain.logger.info("Unsorted array= " + view.displayArray(getUnsortedArray()));
        }
    }

    /**
     * Asks the user for input and returns a desired array size from it.
     *
     * @return desired array size
     */
    public int getDesiredArraySize(){
        System.out.println("------------------------------------------\n"
                +"Enter array size: "
                + "\n------------------------------------------");
        Scanner sc = new Scanner(System.in);
        while(!sc.hasNextInt()){
            SortManagerMain.logger.warn("Incorrect input! Not a number!");
            System.out.println("Incorrect number! Enter a number: ");
            sc.next();
        }
        int desiredArraySize = sc.nextInt();
        if(desiredArraySize < 0){
            SortManagerMain.logger.warn("Negative array size entered!");
            System.out.println("Negative input! Array size will be: " + (desiredArraySize * (-1)));
            desiredArraySize = desiredArraySize * (-1);
        }
        return desiredArraySize;
    }

    /**
     * Asks the user for input and returns a desired array value range from it.
     *
     * @return desired array value range
     */
    public int getDesiredArrayBounds(){
        System.out.println("------------------------------------------\n"
                + "Enter the desired maximum possible number: "
                + "\n------------------------------------------");
        Scanner sc = new Scanner(System.in);
        while(!sc.hasNextInt()){
            SortManagerMain.logger.warn("Incorrect input! Not a number!");
            System.out.println("Incorrect number! Enter a number: ");
            sc.next();
        }
        int desiredArrayBounds = sc.nextInt();
        if(desiredArrayBounds < 0){
            SortManagerMain.logger.warn("Negative array range entered!");
            System.out.println("Negative input! Maximum number will be: " + (desiredArrayBounds * (-1)));
            desiredArrayBounds = desiredArrayBounds * (-1);
        }
        return desiredArrayBounds;
    }

    /**
     * Asks the user if they want to create a random or a custom array.
     *
     * @return desired array type
     */
    public String getDesiredArrayType(){
        System.out.println("------------------------------------------\n" +
                "Would you like to generate a random or a custom array? Enter \"random\" or \"custom\".\n"
                + "------------------------------------------");
        Scanner sc = new Scanner(System.in);
        String desiredArrayType = sc.next();
        while(!desiredArrayType.equalsIgnoreCase("random")
                && !desiredArrayType.equalsIgnoreCase("custom")){
            System.out.println("Incorrect answer! Try again: ");
            desiredArrayType =sc.next();
        }
        return desiredArrayType.toLowerCase();
    }
}
